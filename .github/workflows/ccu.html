<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCU Calvary Newsletter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Basic styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Tailwind gray-50 */
        }
        /* Style for active tab */
        .tab-button.active {
            background-color: #4f46e5; /* Tailwind indigo-600 */
            color: white;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        /* Style for inactive tab */
        .tab-button {
            background-color: #e5e7eb; /* Tailwind gray-200 */
            color: #374151; /* Tailwind gray-700 */
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
        }
        .tab-button:hover {
             background-color: #d1d5db; /* Tailwind gray-300 */
        }
        /* Hide content sections by default */
        .tab-content {
            display: none;
        }
        /* Show active content section */
        .tab-content.active {
            display: block;
        }
        /* Ensure icons align nicely */
        .icon {
             width: 1.5rem; /* 24px */
             height: 1.5rem; /* 24px */
             display: inline-block;
             vertical-align: middle;
             flex-shrink: 0; /* Prevent icons from shrinking in flex layouts */
        }
        .icon-lg {
            width: 5rem; /* 80px */
            height: 5rem; /* 80px */
        }
        .icon-md {
             width: 4.375rem; /* 70px */
             height: 4.375rem; /* 70px */
        }
        .icon-sm {
            width: 1.25rem; /* 20px */
            height: 1.25rem; /* 20px */
        }
         .icon-xs {
            width: 1rem; /* 16px */
            height: 1rem; /* 16px */
        }
        /* Custom legend styles */
        .chart-legend {
            display: grid;
            /* Start with 1 column on mobile, 2 on medium screens */
            grid-template-columns: repeat(1, minmax(0, 1fr));
            gap: 0.5rem; /* Corresponds to gap-2 */
        }
        /* Apply 2 columns for medium screens and up */
        @media (min-width: 768px) { /* md breakpoint */
            .chart-legend {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem; /* Corresponds to gap-2 */
            margin-bottom: 0.25rem; /* Corresponds to mb-1 */
        }
        .legend-color-box {
            width: 0.75rem; /* Corresponds to w-3 */
            height: 0.75rem; /* Corresponds to h-3 */
            border-radius: 9999px; /* Corresponds to rounded-full */
            flex-shrink: 0;
        }
        .legend-label {
            font-size: 0.875rem; /* Corresponds to text-sm */
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        /* Ensure chart canvas container allows resizing */
        .chart-container {
            position: relative;
            width: 100%;
            /* Removed fixed height, set a min-height for very small charts */
            min-height: 200px;
            /* Aspect ratio can be controlled via Chart.js options if needed */
        }
        .bar-chart-container {
             position: relative;
             width: 100%;
             min-height: 350px; /* Min height for bar chart */
        }

    </style>
</head>
<body class="bg-gray-50">

    <div class="max-w-6xl mx-auto p-3 sm:p-4 font-sans">
        <div class="bg-gradient-to-r from-purple-600 via-indigo-600 to-pink-600 text-white p-4 md:p-6 rounded-2xl shadow-lg text-center mb-4 md:mb-6">
            <h1 class="text-2xl sm:text-3xl md:text-4xl font-bold mb-1 sm:mb-2">CCU Calvary Newsletter</h1>
            <h2 class="text-lg sm:text-xl md:text-2xl opacity-90">March-April 2025</h2>
        </div>

        <div class="flex flex-wrap justify-center gap-2 mb-4 md:mb-6">
            <button data-tab="main" class="tab-button px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-medium active">Main</button>
            <button data-tab="metCalls" class="tab-button px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-medium">MET Calls</button>
            <button data-tab="auditResults" class="tab-button px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-medium">Audit Results</button>
            <button data-tab="alerts" class="tab-button px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-medium">Alerts</button>
            <button data-tab="riskman" class="tab-button px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-medium">Riskman</button>
        </div>

        <div class="mt-4">
            <div id="main-content" class="tab-content active">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-4 md:mb-6">
                    <div class="bg-gradient-to-br from-indigo-500 to-indigo-600 p-4 md:p-6 rounded-2xl shadow-lg text-white transform transition-all hover:scale-105 hover:shadow-xl relative overflow-hidden">
                        <div class="absolute right-4 bottom-4 md:right-5 md:bottom-5 opacity-20">
                             <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/moon.svg" alt="Moon" class="icon-lg text-white"/>
                        </div>
                        <div class="flex items-center gap-3 mb-3">
                            <div class="bg-white p-2 rounded-full">
                                <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/moon.svg" alt="Moon" class="icon text-indigo-600"/>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold">Night Shifts</h3>
                        </div>
                        <p class="relative z-10 text-sm md:text-base">Falling asleep on the job is not a good look! A few staff have been observed sleeping off whilst on shift (not on break). If you feel tired, see if you can negotiate a quick 15min extra nap. Come and see Sarah or Tim if doing too many nights in a row and we will see what can be done.</p>
                        <img
                            src="https://placehold.co/70x70/a78bfa/ffffff?text=Night"
                            alt="Night shift icon"
                            class="absolute top-4 right-4 md:top-6 md:right-6 rounded-lg opacity-80 w-[50px] h-[50px] md:w-[70px] md:h-[70px]"
                            onerror="this.onerror=null; this.src='https://placehold.co/70x70/cccccc/ffffff?text=Error';"
                        />
                    </div>

                    <div class="bg-gradient-to-br from-red-500 to-red-600 p-4 md:p-6 rounded-2xl shadow-lg text-white transform transition-all hover:scale-105 hover:shadow-xl relative overflow-hidden">
                        <div class="absolute right-4 bottom-4 md:right-5 md:bottom-5 opacity-20">
                            <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/alert-triangle.svg" alt="Alert Triangle" class="icon-lg text-white"/>
                        </div>
                        <div class="flex items-center gap-3 mb-3">
                            <div class="bg-white p-2 rounded-full">
                                <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/alert-triangle.svg" alt="Alert Triangle" class="icon text-red-600"/>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold">Sharps!</h3>
                        </div>
                        <p class="relative z-10 text-sm md:text-base">A reminder to take time preparing and disposing of any sharps. No one wants to go through the hassle of a needle stick injury! Take everything you need to the bedspace and have a line of sight to the sharps bin.</p>
                        <img
                            src="https://placehold.co/70x70/f87171/ffffff?text=Sharps"
                            alt="Sharps disposal icon"
                            class="absolute top-4 right-4 md:top-6 md:right-6 rounded-lg opacity-80 w-[50px] h-[50px] md:w-[70px] md:h-[70px]"
                            onerror="this.onerror=null; this.src='https://placehold.co/70x70/cccccc/ffffff?text=Error';"
                        />
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 mb-4 md:mb-6">
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 p-4 md:p-6 rounded-2xl shadow-lg text-white transform transition-all hover:scale-105 hover:shadow-xl relative overflow-hidden">
                        <div class="absolute right-4 bottom-4 md:right-5 md:bottom-5 opacity-20">
                             <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/droplet.svg" alt="Droplet" class="icon-md text-white"/>
                        </div>
                        <div class="flex items-center gap-3 mb-3">
                            <div class="bg-white p-2 rounded-full">
                               <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/droplet.svg" alt="Droplet" class="icon text-blue-600"/>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold">IV Fluid Shortage</h3>
                        </div>
                        <p class="relative z-10 text-sm md:text-base">Nationwide there is a shortage of 100ml NaCl bags, please be mindful with this and push what medications are able to be.</p>
                    </div>

                    <div class="bg-gradient-to-br from-green-500 to-green-600 p-4 md:p-6 rounded-2xl shadow-lg text-white md:col-span-2 transform transition-all hover:scale-105 hover:shadow-xl relative overflow-hidden">
                        <div class="absolute right-4 bottom-4 md:right-5 md:bottom-5 opacity-20">
                            <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/clipboard.svg" alt="Clipboard" class="icon-lg text-white"/>
                        </div>
                        <div class="flex items-center gap-3 mb-3">
                            <div class="bg-white p-2 rounded-full">
                                <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/clipboard.svg" alt="Clipboard" class="icon text-green-600"/>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold">Documentation</h3>
                        </div>
                        <p class="relative z-10 text-sm md:text-base">Please ensure you are documenting devices such as lines, dressings, drains and how the site appears and what has been escalated if needed. After a recent review it seems we have slipped off in this area! Vitro should be updated to include ALL invasive devices and VIP scores.</p>
                        <img
                            src="https://placehold.co/70x70/4ade80/ffffff?text=Docs"
                            alt="Documentation icon"
                            class="absolute top-4 right-4 md:top-6 md:right-6 rounded-lg opacity-80 w-[50px] h-[50px] md:w-[70px] md:h-[70px]"
                            onerror="this.onerror=null; this.src='https://placehold.co/70x70/cccccc/ffffff?text=Error';"
                        />
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6">
                     <div class="bg-gradient-to-br from-yellow-500 to-yellow-600 p-4 md:p-6 rounded-2xl shadow-lg text-white transform transition-all hover:scale-105 hover:shadow-xl relative overflow-hidden">
                        <div class="absolute right-4 bottom-4 md:right-5 md:bottom-5 opacity-20">
                            <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/file-text.svg" alt="File Text" class="icon-md text-white"/>
                        </div>
                        <div class="flex items-center gap-3 mb-3">
                            <div class="bg-white p-2 rounded-full">
                                <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/file-text.svg" alt="File Text" class="icon text-yellow-600"/>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold">Oxygen Stickers</h3>
                        </div>
                        <p class="relative z-10 text-sm md:text-base">Please make sure any patient on oxygen that goes to the ward is transferred with a white oxygen sticker on the medication chart with relevant targets. HFNP requires a separate form.</p>
                    </div>

                    <div class="bg-gradient-to-br from-purple-500 to-purple-600 p-4 md:p-6 rounded-2xl shadow-lg text-white transform transition-all hover:scale-105 hover:shadow-xl relative overflow-hidden">
                        <div class="absolute right-4 bottom-4 md:right-5 md:bottom-5 opacity-20">
                            <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/users.svg" alt="Users" class="icon-md text-white"/>
                        </div>
                        <div class="flex items-center gap-3 mb-3">
                            <div class="bg-white p-2 rounded-full">
                                <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/users.svg" alt="Users" class="icon text-purple-600"/>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold">New Staff</h3>
                        </div>
                        <p class="relative z-10 text-sm md:text-base">We have a number of new staff, and a guide outlining roles and responsibilities is underway to assist with in-charge allocation. This will be located in the shift in charge folder.</p>
                    </div>

                    <div class="bg-gradient-to-br from-pink-500 to-pink-600 p-4 md:p-6 rounded-2xl shadow-lg text-white transform transition-all hover:scale-105 hover:shadow-xl relative overflow-hidden">
                        <div class="absolute right-4 bottom-4 md:right-5 md:bottom-5 opacity-20">
                            <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/pill.svg" alt="Pill" class="icon-md text-white"/>
                        </div>
                        <div class="flex items-center gap-3 mb-3">
                            <div class="bg-white p-2 rounded-full">
                                <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/pill.svg" alt="Pill" class="icon text-pink-600"/>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold">Medication Clutter</h3>
                        </div>
                        <p class="relative z-10 text-sm md:text-base">Please don't leave medications lying on benches / not locked away. eg: Heparin syringes, Paracetamol etc in the HDU end seems to be an ongoing issue.</p>
                    </div>
                </div>
            </div>

            <div id="metCalls-content" class="tab-content">
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                    <div class="bg-gradient-to-br from-blue-500 via-blue-600 to-blue-700 p-4 md:p-6 rounded-2xl shadow-lg text-white transform transition-all hover:scale-105 hover:shadow-xl">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="bg-white p-2 rounded-full">
                                <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/activity.svg" alt="Activity" class="icon text-blue-600"/>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold">Calls by Hospital Unit</h3>
                        </div>
                        <div class="bg-blue-50 p-2 sm:p-4 rounded-xl mb-4 chart-container">
                            <canvas id="hospitalUnitChart"></canvas>
                        </div>
                        <div id="hospitalUnitLegend" class="chart-legend">
                            </div>
                    </div>

                    <div class="bg-gradient-to-br from-green-500 via-green-600 to-green-700 p-4 md:p-6 rounded-2xl shadow-lg text-white transform transition-all hover:scale-105 hover:shadow-xl">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="bg-white p-2 rounded-full">
                                <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/heart.svg" alt="Heart" class="icon text-green-600"/>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold">Primary Reasons for Calls</h3>
                        </div>
                        <div class="bg-green-50 p-2 sm:p-4 rounded-xl mb-4 chart-container">
                            <canvas id="reasonsChart"></canvas>
                        </div>
                        <div id="reasonsLegend" class="chart-legend">
                            </div>
                    </div>

                    <div class="bg-gradient-to-br from-indigo-500 via-indigo-600 to-indigo-700 p-4 md:p-6 rounded-2xl shadow-lg text-white md:col-span-2 transform transition-all hover:scale-105 hover:shadow-xl">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="bg-white p-2 rounded-full">
                                <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/plus-circle.svg" alt="Plus Circle" class="icon text-indigo-600"/>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold">MET Call Insights</h3>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 md:gap-4">
                            <div class="bg-white p-3 md:p-4 rounded-xl shadow text-gray-800 flex items-center">
                                <div class="h-10 w-10 sm:h-12 sm:w-12 rounded-full bg-blue-100 flex items-center justify-center mr-3 sm:mr-4 flex-shrink-0">
                                    <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/thermometer.svg" alt="Thermometer" class="icon text-blue-600"/>
                                </div>
                                <div>
                                    <h4 class="font-bold text-sm sm:text-base">Hypotension</h4>
                                    <p class="text-gray-600 text-xs sm:text-sm">Leading cause at 21%</p>
                                </div>
                            </div>
                             <div class="bg-white p-3 md:p-4 rounded-xl shadow text-gray-800 flex items-center">
                                <div class="h-10 w-10 sm:h-12 sm:w-12 rounded-full bg-teal-100 flex items-center justify-center mr-3 sm:mr-4 flex-shrink-0">
                                     <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/activity.svg" alt="Activity" class="icon text-teal-600"/>
                                </div>
                                <div>
                                    <h4 class="font-bold text-sm sm:text-base">Rehabilitation</h4>
                                    <p class="text-gray-600 text-xs sm:text-sm">Highest unit at 29%</p>
                                </div>
                            </div>
                             <div class="bg-white p-3 md:p-4 rounded-xl shadow text-gray-800 flex items-center">
                                <div class="h-10 w-10 sm:h-12 sm:w-12 rounded-full bg-purple-100 flex items-center justify-center mr-3 sm:mr-4 flex-shrink-0">
                                    <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/bar-chart-2.svg" alt="Bar Chart 2" class="icon text-purple-600"/>
                                </div>
                                <div>
                                    <h4 class="font-bold text-sm sm:text-base">Trending</h4>
                                    <p class="text-gray-600 text-xs sm:text-sm">30% increase this month</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="auditResults-content" class="tab-content">
                 <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6">
                    <div class="bg-gradient-to-br from-teal-500 via-teal-600 to-teal-700 p-4 md:p-6 rounded-2xl shadow-lg text-white md:col-span-2 transform transition-all hover:shadow-xl">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="bg-white p-2 rounded-full">
                                <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/award.svg" alt="Award" class="icon text-teal-600"/>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold">Audit Performance</h3>
                        </div>
                        <div class="bg-teal-50 border-l-4 border-teal-300 p-3 md:p-4 rounded-lg mb-4 md:mb-6 text-teal-800">
                            <p class="flex items-center text-sm md:text-base">
                                <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/alert-triangle.svg" alt="Alert Triangle" class="icon-sm mr-2 text-yellow-600 flex-shrink-0"/>
                                VTE audit results remain low. Please ensure medical staff fill in the VTE section on medication charts.
                            </p>
                        </div>
                        <div class="bg-white p-2 sm:p-4 rounded-xl bar-chart-container">
                            <canvas id="auditChart"></canvas>
                        </div>
                    </div>

                    <div class="bg-gradient-to-br from-orange-500 via-orange-600 to-orange-700 p-4 md:p-6 rounded-2xl shadow-lg text-white transform transition-all hover:shadow-xl">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="bg-white p-2 rounded-full">
                                <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/database.svg" alt="Database" class="icon text-orange-600"/>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold">Focus Areas</h3>
                        </div>
                        <div class="overflow-y-auto max-h-96">
                            <table class="min-w-full bg-white rounded-xl overflow-hidden shadow text-gray-800 mb-4">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="px-3 py-2 sm:px-4 sm:py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Audit Area</th>
                                        <th class="px-3 py-2 sm:px-4 sm:py-3 text-center text-xs font-medium text-gray-600 uppercase tracking-wider">Score</th>
                                    </tr>
                                </thead>
                                <tbody id="criticalScoresTableBody">
                                    <tr>
                                         <td colspan="2" class="px-4 py-3 text-center text-sm text-gray-500">Loading...</td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="bg-white p-3 md:p-4 rounded-xl text-gray-800">
                                <h4 class="font-bold text-orange-700 mb-2 flex items-center text-sm sm:text-base">
                                    <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/alert-triangle.svg" alt="Alert Triangle" class="w-4 h-4 mr-2"/> Action Required
                                </h4>
                                <p class="text-xs sm:text-sm" id="actionRequiredText">Loading VTE score...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="alerts-content" class="tab-content">
                 <div class="bg-white p-4 md:p-6 rounded-2xl shadow-lg text-gray-800">
                    <div class="flex items-center gap-3 mb-4 md:mb-6 border-b pb-3">
                        <div class="bg-red-100 p-2 rounded-full">
                            <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/bell.svg" alt="Bell" class="icon text-red-600"/>
                        </div>
                        <h3 class="text-xl sm:text-2xl font-bold text-gray-700">Important Alerts</h3>
                    </div>

                    <div class="mb-6 md:mb-8">
                        <h4 class="text-base sm:text-lg font-semibold mb-3 text-gray-600 flex items-center">
                            <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/pill.svg" alt="Pill" class="icon-sm mr-2 text-yellow-600"/>Drug Availability Updates
                        </h4>
                        <div class="bg-yellow-50 p-3 md:p-4 rounded-lg mb-4 border-l-4 border-yellow-500 shadow-sm">
                            <h5 class="font-medium mb-2 text-yellow-800 text-sm sm:text-base">Naropin® with Fentanyl Discontinuation</h5>
                            <p class="mb-2 text-xs sm:text-sm text-gray-700">HPS Pharmacies advises that Aspen Pharmacare Australia is discontinuing Naropin® with Fentanyl injection bags as follows:</p>
                            <ul class="list-disc pl-5 sm:pl-6 text-xs sm:text-sm text-gray-600 space-y-1">
                                <li>Naropin® 0.2% with Fentanyl 200 (100mL) - ropivacaine hydrochloride 2mg/mL + fentanyl 2 micrograms/mL - ARTG 72874</li>
                                <li>Naropin® 0.2% with Fentanyl 400 (100mL) - Ropivacaine hydrochloride 2 mg/mL + fentanyl 4 micrograms/mL - ARTG 72876</li>
                                <li>Naropin® 0.2% with Fentanyl 400 (200mL) - Ropivacaine hydrochloride 2 mg/mL + fentanyl 2 micrograms/mL - ARTG 72873</li>
                                <li>Naropin® 0.2% with Fentanyl 800 (200mL) - Ropivacaine hydrochloride 2 mg/mL + fentanyl 4 micrograms/mL - ARTG 72875</li>
                            </ul>
                        </div>
                        <div class="bg-yellow-50 p-3 md:p-4 rounded-lg mb-4 border-l-4 border-yellow-500 shadow-sm">
                            <h5 class="font-medium mb-2 text-yellow-800 text-sm sm:text-base">Amiodarone Supply Interruption</h5>
                            <p class="mb-2 text-xs sm:text-sm text-gray-700">HPS Pharmacies wish to advise that Juno Pharmaceuticals is continuing to experience a supply interruption for Amiodarone Juno ampoules as follows:</p>
                            <ul class="list-disc pl-5 sm:pl-6 text-xs sm:text-sm text-gray-600">
                                <li>Amiodarone hydrochloride 150mg/3mL - ARTG 233673</li>
                            </ul>
                            <p class="mt-2 text-xs sm:text-sm text-gray-700">This supply interruption is anticipated to continue until <span class="font-semibold">late June 2025</span>.</p>
                        </div>
                    </div>

                    <div>
                        <h4 class="text-base sm:text-lg font-semibold mb-3 text-gray-600 flex items-center">
                           <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/alert-octagon.svg" alt="Alert Octagon" class="icon-sm mr-2 text-blue-600"/>Electric Shock Safety
                        </h4>
                         <div class="bg-blue-50 p-3 md:p-4 rounded-lg border-l-4 border-blue-500 shadow-sm">
                            <p class="mb-3 text-xs sm:text-sm text-gray-700">Electric shocks can be dangerous. Know the steps to stay safe and help others.</p>
                            <h5 class="font-medium mb-1 text-blue-800 text-sm sm:text-base">Key Safety Tips</h5>
                            <ul class="list-disc pl-5 sm:pl-6 mb-3 text-xs sm:text-sm text-gray-600 space-y-1">
                                <li>Never touch exposed wires.</li>
                                <li>Ensure electrical devices are tested & tagged.</li>
                                <li>Keep power points switched off when not in use or when plugging/unplugging devices.</li>
                                <li>Check cords for damage before using equipment.</li>
                            </ul>
                            <h5 class="font-medium mb-1 text-blue-800 text-sm sm:text-base">What to do if you or someone else gets an electric shock</h5>
                            <ul class="list-disc pl-5 sm:pl-6 mb-3 text-xs sm:text-sm text-gray-600 space-y-1">
                                <li>Report the incident immediately to your manager or the Hospital Coordinator.</li>
                                <li>Attend the Emergency Department for an ECG.</li>
                                <li>Ensure a Riskman incident is logged.</li>
                            </ul>
                            <p class="font-bold text-red-700 text-xs sm:text-sm border-t border-blue-200 pt-3 mt-3">
                                <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/alert-triangle.svg" alt="Alert Triangle" class="icon-xs inline mr-1"/>
                                Electric shocks are a NOTIFIABLE incident. Worksafe Tasmania as well as TasNetworks must be notified by the Executive on call, who will either do this themselves or delegate to WHS or the Facilities Manager to do so.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="riskman-content" class="tab-content">
                 <div class="bg-white p-4 md:p-6 rounded-2xl shadow-lg text-gray-800">
                    <div class="flex items-center gap-3 mb-4 md:mb-6 border-b pb-3">
                        <div class="bg-purple-100 p-2 rounded-full">
                             <img src="https://cdn.jsdelivr.net/npm/lucide-static@latest/icons/clipboard.svg" alt="Clipboard" class="icon text-purple-600"/>
                        </div>
                        <h3 class="text-xl sm:text-2xl font-bold text-gray-700">Riskman - February Results</h3>
                    </div>

                    <div class="mb-6 md:mb-8 p-3 md:p-4 bg-gray-50 rounded-lg border border-gray-200">
                        <h4 class="text-base sm:text-lg font-semibold mb-3 text-gray-600">Confirmed Harm Scores</h4>
                        <div class="flex space-x-4 sm:space-x-6" id="harmScoreDistribution">
                            <p class="text-sm text-gray-500">Loading scores...</p>
                        </div>
                        <p class="text-xs text-gray-500 mt-3">*Harm Score 3: Moderate Harm, Harm Score 4: Minor Harm/Near Miss</p>
                    </div>

                    <div>
                        <h4 class="text-base sm:text-lg font-semibold mb-3 text-gray-600">Harm Scores by Incident Type</h4>
                        <div class="overflow-x-auto rounded-lg border border-gray-200">
                            <table class="min-w-full bg-white">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="px-3 py-2 sm:px-4 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Incident Type</th>
                                        <th class="px-3 py-2 sm:px-4 sm:py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Harm Score 3</th>
                                        <th class="px-3 py-2 sm:px-4 sm:py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Harm Score 4</th>
                                        <th class="px-3 py-2 sm:px-4 sm:py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Total</th>
                                    </tr>
                                </thead>
                                <tbody id="incidentsTableBody" class="divide-y divide-gray-200">
                                    <tr>
                                         <td colspan="4" class="px-4 py-3 text-center text-sm text-gray-500">Loading incidents...</td>
                                    </tr>
                                </tbody>
                                <tfoot id="incidentsTableFoot" class="bg-gray-100">
                                     </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Data (same as React component) ---
        const hospitalUnitData = [
            { name: 'Rehab Services', value: 29 }, { name: 'First North', value: 21 },
            { name: 'First East', value: 21 }, { name: 'General Surgical', value: 21 },
            { name: 'Gibson Unit', value: 4 }, { name: 'Neuro-Cardio', value: 4 }
        ];
        const reasonsData = [
            { name: 'Hypotension', value: 21 }, { name: 'Nurse Concern', value: 17 },
            { name: 'Chest Pain', value: 13 }, { name: 'Tachycardia', value: 13 },
            { name: 'Respiratory', value: 8 }, { name: 'Surg. Issues', value: 8 },
            { name: 'Decreased GCS', value: 8 }, { name: 'Other', value: 12 }
        ];
        const auditData = [
            { name: 'Aseptic Technique', score: 96, audits: 3 }, { name: 'Blood Transfusion', score: 95, audits: 7 },
            { name: 'Communication', score: 96, audits: 3 }, { name: 'Comprehensive Care', score: 93, audits: 4 },
            { name: 'Invasive Devices', score: 75, audits: 3 }, { name: 'RRAD Audit', score: 98, audits: 3 },
            { name: 'S8 Medication', score: 87, audits: 5 }, { name: 'VTE Assessment', score: 62, audits: 3 },
            { name: 'Accreditation', score: 92, audits: 2 }
        ];
         const harmScoreDistributionData = { score3: 22, score4: 78 };
         const incidentsByTypeData = [
            { type: 'Medication/IV Fluid', score3: 0, score4: 8, total: 8 },
            { type: 'Equipment / Facility', score3: 0, score4: 5, total: 5 },
            { type: 'Clinical Management', score3: 0, score4: 3, total: 3 },
            { type: 'Skin Integrity/Pressure Injury', score3: 2, score4: 1, total: 3 },
            { type: 'Alleged Violence / Aggression', score3: 2, score4: 1, total: 3 },
         ];

        // --- Chart Colors ---
        const CHART_COLORS = ['#0088FE', '#00C49F', '#FFBB28', '#FF8042', '#8884d8', '#82ca9d', '#ffc658', '#d0ed57'];

        // --- Chart Instances ---
        let hospitalUnitChartInstance = null;
        let reasonsChartInstance = null;
        let auditChartInstance = null;

        // --- Helper Functions ---
        function getScoreColor(score) {
            if (score >= 95) return '#10B981'; // Green
            if (score >= 90) return '#22D3EE'; // Teal
            if (score >= 80) return '#F59E0B'; // Yellow
            return '#EF4444'; // Red
        }

        function getBadgeClass(score) {
            if (score >= 95) return 'bg-green-100 text-green-800';
            if (score >= 90) return 'bg-teal-100 text-teal-800';
            if (score >= 80) return 'bg-yellow-100 text-yellow-800';
            return 'bg-red-100 text-red-800';
        }

        // Function to create custom HTML legend
        function createLegend(chartData, colors, legendContainerId) {
            const legendContainer = document.getElementById(legendContainerId);
            if (!legendContainer) return;
            legendContainer.innerHTML = ''; // Clear existing legend
            chartData.forEach((item, index) => {
                const color = colors[index % colors.length];
                const legendItem = document.createElement('div');
                legendItem.className = 'legend-item';
                legendItem.innerHTML = `
                    <div style="background-color: ${color};" class="legend-color-box"></div>
                    <span class="legend-label">${item.name}: <b>${item.value}%</b></span>
                `;
                legendContainer.appendChild(legendItem);
            });
        }

        // --- Chart Creation Functions ---
        function createHospitalUnitChart() {
            const ctx = document.getElementById('hospitalUnitChart')?.getContext('2d');
            if (!ctx) return;
            if (hospitalUnitChartInstance) hospitalUnitChartInstance.destroy();

            hospitalUnitChartInstance = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: hospitalUnitData.map(d => d.name),
                    datasets: [{
                        data: hospitalUnitData.map(d => d.value),
                        backgroundColor: CHART_COLORS,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true, // Allow aspect ratio to adjust slightly more freely
                    aspectRatio: 1.5, // Adjust aspect ratio for potentially smaller height on mobile
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) label += ': ';
                                    if (context.parsed !== null) label += context.parsed + '%';
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
            createLegend(hospitalUnitData, CHART_COLORS, 'hospitalUnitLegend');
        }

        function createReasonsChart() {
            const ctx = document.getElementById('reasonsChart')?.getContext('2d');
             if (!ctx) return;
            if (reasonsChartInstance) reasonsChartInstance.destroy();

            reasonsChartInstance = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: reasonsData.map(d => d.name),
                    datasets: [{
                        data: reasonsData.map(d => d.value),
                        backgroundColor: CHART_COLORS,
                        hoverOffset: 4
                    }]
                },
                 options: {
                    responsive: true,
                    maintainAspectRatio: true, // Allow aspect ratio adjustment
                    aspectRatio: 1.5, // Adjust aspect ratio
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                             callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) label += ': ';
                                    if (context.parsed !== null) label += context.parsed + '%';
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
             createLegend(reasonsData, CHART_COLORS, 'reasonsLegend');
        }

        function createAuditChart() {
            const ctx = document.getElementById('auditChart')?.getContext('2d');
             if (!ctx) return;
            if (auditChartInstance) auditChartInstance.destroy();

            auditChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: auditData.map(d => d.name),
                    datasets: [{
                        label: 'Score (%)',
                        data: auditData.map(d => d.score),
                        backgroundColor: auditData.map(d => getScoreColor(d.score)),
                        borderColor: auditData.map(d => getScoreColor(d.score)),
                        borderWidth: 1,
                        borderRadius: { topLeft: 4, topRight: 4 }
                    }]
                },
                options: {
                    indexAxis: 'x',
                    responsive: true,
                    maintainAspectRatio: false, // Allow height to adjust based on container
                    scales: {
                        x: {
                            ticks: {
                                font: { size: 9 }, // Slightly smaller font for mobile potentially
                                autoSkip: false,
                                maxRotation: 60, // Allow more rotation if needed
                                minRotation: 45
                            },
                             grid: { display: false }
                        },
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Score (%)',
                                font: { size: 10 } // Smaller axis title
                            },
                             ticks: { font: { size: 10 } } // Smaller Y axis ticks
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const dataIndex = context.dataIndex;
                                    const score = context.parsed.y;
                                    const audits = auditData[dataIndex].audits;
                                    return `Score: ${score}% (${audits} audits)`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // --- Populate Tables ---
        function populateCriticalScoresTable() {
             const tableBody = document.getElementById('criticalScoresTableBody');
             const actionRequiredText = document.getElementById('actionRequiredText');
             if (!tableBody || !actionRequiredText) return;

             tableBody.innerHTML = '';

             const criticalScores = auditData
                .filter(item => item.score < 95)
                .sort((a, b) => a.score - b.score);

             if (criticalScores.length > 0) {
                 criticalScores.forEach((item, index) => {
                     const row = tableBody.insertRow();
                     // Added responsive padding to table cells
                     row.className = `${index % 2 === 0 ? 'bg-white' : 'bg-gray-50'} border-b border-gray-200 last:border-b-0`;
                     row.innerHTML = `
                        <td class="px-3 py-2 sm:px-4 sm:py-3 text-xs sm:text-sm text-gray-700">${item.name}</td>
                        <td class="px-3 py-2 sm:px-4 sm:py-3 text-center">
                            <span class="inline-flex items-center px-2 py-0.5 sm:px-2.5 rounded-full text-xs sm:text-sm font-medium ${getBadgeClass(item.score)}">
                                ${item.score}% (${item.audits})
                            </span>
                        </td>
                     `;
                 });
             } else {
                  const row = tableBody.insertRow();
                  row.innerHTML = `<td colspan="2" class="px-4 py-3 text-center text-sm text-gray-500">No scores below threshold.</td>`;
             }

             const vteScore = auditData.find(i => i.name === 'VTE Assessment')?.score || 'N/A';
             actionRequiredText.textContent = `Please focus on improving VTE assessment completion. Current rate of ${vteScore}% is significantly below the 90% target threshold.`;
        }

        function populateRiskmanData() {
            const harmScoreContainer = document.getElementById('harmScoreDistribution');
            const incidentsBody = document.getElementById('incidentsTableBody');
            const incidentsFoot = document.getElementById('incidentsTableFoot');

            if (!harmScoreContainer || !incidentsBody || !incidentsFoot) return;

            // Populate Harm Score Distribution: Adjusted text size for mobile
            harmScoreContainer.innerHTML = `
                <div class="text-center">
                    <p class="text-2xl sm:text-3xl font-bold text-red-600">${harmScoreDistributionData.score3}%</p>
                    <p class="text-xs sm:text-sm text-gray-500">Harm Score 3</p>
                </div>
                <div class="text-center">
                    <p class="text-2xl sm:text-3xl font-bold text-orange-600">${harmScoreDistributionData.score4}%</p>
                    <p class="text-xs sm:text-sm text-gray-500">Harm Score 4</p>
                </div>
            `;

            incidentsBody.innerHTML = '';
            let totalScore3 = 0;
            let totalScore4 = 0;
            let grandTotal = 0;

            incidentsByTypeData.forEach((incident, index) => {
                totalScore3 += incident.score3;
                totalScore4 += incident.score4;
                grandTotal += incident.total;
                const row = incidentsBody.insertRow();
                // Added responsive padding to table cells
                row.className = index % 2 === 0 ? 'bg-white' : 'bg-gray-50';
                row.innerHTML = `
                    <td class="px-3 py-2 sm:px-4 sm:py-3 whitespace-nowrap text-xs sm:text-sm text-gray-700">${incident.type}</td>
                    <td class="px-3 py-2 sm:px-4 sm:py-3 whitespace-nowrap text-xs sm:text-sm text-center text-red-600">${incident.score3}</td>
                    <td class="px-3 py-2 sm:px-4 sm:py-3 whitespace-nowrap text-xs sm:text-sm text-center text-orange-600">${incident.score4}</td>
                    <td class="px-3 py-2 sm:px-4 sm:py-3 whitespace-nowrap text-xs sm:text-sm text-center font-bold text-gray-800">${incident.total}</td>
                `;
            });

            // Populate Incidents Table Footer: Added responsive padding
            incidentsFoot.innerHTML = `
                 <tr>
                   <td class="px-3 py-2 sm:px-4 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total Incidents</td>
                   <td class="px-3 py-2 sm:px-4 sm:py-3 text-center text-sm font-bold text-red-600">${totalScore3}</td>
                   <td class="px-3 py-2 sm:px-4 sm:py-3 text-center text-sm font-bold text-orange-600">${totalScore4}</td>
                   <td class="px-3 py-2 sm:px-4 sm:py-3 text-center text-sm font-bold text-gray-800">${grandTotal}</td>
                 </tr>
            `;
        }


        // --- Tab Switching Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const tabs = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            let activeCharts = {}; // Keep track of initialized charts for the active tab

            function showTab(tabId) {
                 tabContents.forEach(content => {
                    content.classList.remove('active');
                 });
                 tabs.forEach(tab => {
                    tab.classList.remove('active');
                 });

                 const activeContent = document.getElementById(`${tabId}-content`);
                 const activeTabButton = document.querySelector(`.tab-button[data-tab="${tabId}"]`);

                 if (activeContent) activeContent.classList.add('active');
                 if (activeTabButton) activeTabButton.classList.add('active');

                 // Clear previous active charts if any
                 activeCharts = {};

                 // Initialize content/charts for the newly active tab
                 // Use requestAnimationFrame to ensure the canvas is visible before drawing
                 requestAnimationFrame(() => {
                     if (tabId === 'metCalls') {
                         if (!activeCharts.hospitalUnit) activeCharts.hospitalUnit = createHospitalUnitChart();
                         if (!activeCharts.reasons) activeCharts.reasons = createReasonsChart();
                     } else if (tabId === 'auditResults') {
                         if (!activeCharts.audit) activeCharts.audit = createAuditChart();
                         populateCriticalScoresTable();
                     } else if (tabId === 'riskman') {
                         populateRiskmanData();
                     }
                 });
            }

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    showTab(tabId);
                });
            });

            // Show the initial tab
            showTab('main');
        });

    </script>

</body>
</html>
